import{_ as y,E as B,c as L,b as n,a as s,w as a,r as d,g as S,f as h,u as k,o as A}from"./app-nSw-_BHz.js";import{r as w}from"./uploads-CnEkgyD_.js";const P={data(){return{form:{email:"",password:""},loading:!1,showPassword:!1,brandingLogo:null,rules:{required:r=>!!r||"This field is required",email:r=>/.+@.+\..+/.test(r)||"E-mail must be valid"}}},computed:{logoUrl(){return this.brandingLogo?w(this.brandingLogo):"/assets/logo/logo.png"}},async mounted(){await this.loadBrandingSettings()},methods:{...B(k,["login"]),async handleLogin(){var e,m;const{valid:r}=await this.$refs.form.validate();if(r){this.loading=!0;try{await this.login(this.form),this.$router.push({name:"AdminDashboard"})}catch(l){let o="Login failed";if(l.response){if((e=l.response.data)!=null&&e.message)o=l.response.data.message;else if((m=l.response.data)!=null&&m.errors){const t=l.response.data.errors;o=Object.values(t).flat().join(", ")}}window.Swal?window.Swal.fire({icon:"error",title:"Authentication Failed",text:o,confirmButtonColor:"#d33",background:"#fff",iconColor:"#d33"}):alert(o)}finally{this.loading=!1}}},resolveImageUrl(r){return w(r)},async loadBrandingSettings(){var r,e,m,l,o;try{const t=(r=document.querySelector('meta[name="api-base-url"]'))==null?void 0:r.getAttribute("content"),u=t?t.replace(/\/+$/,"")+"/":"",g=u?[`${u}open/settings`,`${u}public/settings`]:["api/v1/open/settings","api/v1/public/settings"];let i=null,p=null;for(const b of g)try{i=await this.$axios.get(b,{params:{group:"branding"}});break}catch(c){if(p=c,((e=c==null?void 0:c.response)==null?void 0:e.status)!==404)throw c}if(!i)throw p||new Error("Branding settings endpoint not found");i.data&&(i.data.logo?this.brandingLogo=i.data.logo:(l=(m=i.data.branding)==null?void 0:m.logo)!=null&&l.value&&(this.brandingLogo=i.data.branding.logo.value))}catch(t){((o=t==null?void 0:t.response)==null?void 0:o.status)!==404&&(t==null?void 0:t.message)!=="Branding settings endpoint not found"&&console.error("Error loading branding settings:",t)}}}},V={class:"login-container fill-height"},U={class:"brand-logo mb-6"},E={class:"d-flex d-md-none justify-center mb-6"};function j(r,e,m,l,o,t){const u=d("v-img"),g=d("v-col"),i=d("v-text-field"),p=d("v-icon"),b=d("v-btn"),c=d("v-form"),v=d("v-row"),_=d("v-card"),x=d("v-container");return A(),L("div",V,[e[9]||(e[9]=n("div",{class:"background-shapes"},[n("div",{class:"shape shape-1"}),n("div",{class:"shape shape-2"}),n("div",{class:"shape shape-3"})],-1)),s(x,{class:"fill-height d-flex align-center justify-center",fluid:""},{default:a(()=>[s(v,{justify:"center"},{default:a(()=>[s(g,{cols:"12",sm:"10",md:"8",lg:"6",xl:"4"},{default:a(()=>[s(_,{class:"login-card glass-effect",elevation:"24"},{default:a(()=>[s(v,{"no-gutters":""},{default:a(()=>[s(g,{cols:"12",md:"6",class:"d-none d-md-flex flex-column align-center justify-center branding-section pa-8"},{default:a(()=>[n("div",U,[s(u,{src:t.logoUrl,alt:"Logo",width:"120",class:"drop-shadow rounded-logo",cover:""},null,8,["src"])]),e[3]||(e[3]=n("h2",{class:"text-white text-h4 font-weight-bold mb-2 text-center"},"Welcome Back!",-1)),e[4]||(e[4]=n("p",{class:"text-white text-body-1 text-center opacity-80"}," Sign in to access your dashboard and manage your business efficiently. ",-1))]),_:1,__:[3,4]}),s(g,{cols:"12",md:"6",class:"form-section pa-8 bg-white"},{default:a(()=>[n("div",E,[s(u,{src:t.logoUrl,alt:"Logo",width:"80",class:"rounded-logo",cover:""},null,8,["src"])]),e[6]||(e[6]=n("h3",{class:"text-h5 font-weight-bold text-primary mb-1 text-center text-md-left"},"Admin Login",-1)),e[7]||(e[7]=n("p",{class:"text-caption text-grey mb-8 text-center text-md-left"},"Please enter your credentials to continue",-1)),s(c,{onSubmit:S(t.handleLogin,["prevent"]),ref:"form"},{default:a(()=>[s(i,{modelValue:o.form.email,"onUpdate:modelValue":e[0]||(e[0]=f=>o.form.email=f),label:"Email Address",placeholder:"admin@example.com",type:"email",variant:"outlined",color:"primary","prepend-inner-icon":"mdi-email-outline",rules:[o.rules.required,o.rules.email],class:"mb-2",density:"comfortable"},null,8,["modelValue","rules"]),s(i,{modelValue:o.form.password,"onUpdate:modelValue":e[1]||(e[1]=f=>o.form.password=f),label:"Password",placeholder:"••••••••",type:o.showPassword?"text":"password",variant:"outlined",color:"primary","prepend-inner-icon":"mdi-lock-outline","append-inner-icon":o.showPassword?"mdi-eye-off":"mdi-eye","onClick:appendInner":e[2]||(e[2]=f=>o.showPassword=!o.showPassword),rules:[o.rules.required],class:"mb-6",density:"comfortable"},null,8,["modelValue","type","append-inner-icon","rules"]),s(b,{type:"submit",color:"primary",block:"",size:"large",loading:o.loading,class:"login-btn text-capitalize font-weight-bold mb-4",elevation:"4"},{default:a(()=>[e[5]||(e[5]=h(" Sign In ")),s(p,{end:"",icon:"mdi-arrow-right",class:"ml-2"})]),_:1,__:[5]},8,["loading"])]),_:1},8,["onSubmit"]),e[8]||(e[8]=n("div",{class:"text-center mt-4"},[n("p",{class:"text-caption text-grey"},[h(" Protected by "),n("span",{class:"font-weight-bold text-primary"},"CPB-IT Security")])],-1))]),_:1,__:[6,7,8]})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})])}const I=y(P,[["render",j],["__scopeId","data-v-24024f65"]]);export{I as default};
