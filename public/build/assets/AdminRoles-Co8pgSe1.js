import{c as N}from"./commonMixin-CMso4bz3.js";import{_ as O,d as P,w as l,a as t,r,f as m,t as c,e as A,b as n,g as q,c as p,F as I,z as j,o as d}from"./app-nSw-_BHz.js";const B={name:"RoleDialog",props:{modelValue:{type:Boolean,default:!1},editingRole:{type:Object,default:null},saving:{type:Boolean,default:!1},form:{type:Object,required:!0},rules:{type:Object,default:()=>({})},permissionSearch:{type:String,default:""},filteredGroupedPermissions:{type:Object,default:()=>({})},getSelectedCountInGroup:{type:Function,required:!0},isFormPermissionSelected:{type:Function,required:!0},toggleFormPermission:{type:Function,required:!0},selectAllPermissions:{type:Function,required:!0},deselectAllPermissions:{type:Function,required:!0},selectAllInGroup:{type:Function,required:!0},deselectAllInGroup:{type:Function,required:!0},autoGenerateSlugFromName:{type:Function,required:!0}},emits:["update:modelValue","update:permissionSearch","save","close"],computed:{dialogValue:{get(){return this.modelValue},set(s){this.$emit("update:modelValue",s)}},permissionSearchValue:{get(){return this.permissionSearch},set(s){this.$emit("update:permissionSearch",s)}}},methods:{validateForm(){var s,e;return(e=(s=this.$refs.roleForm)==null?void 0:s.validate)==null?void 0:e.call(s)},resetValidation(){var s,e;(e=(s=this.$refs.roleForm)==null?void 0:s.resetValidation)==null||e.call(s)}}},L={class:"mb-2"},M={class:"d-flex justify-space-between align-center mb-2"},H={class:"d-flex gap-2"},T={key:0,class:"permissions-container mb-4"},J={class:"d-flex align-center gap-2"},K={class:"text-h6"},Q={class:"d-flex gap-1"},W={class:"font-weight-medium"},X={key:0,class:"text-caption text-grey"},Y={key:0},Z={key:1};function $(s,e,i,g,u,o){const h=r("v-card-title"),v=r("v-alert"),_=r("v-text-field"),G=r("v-textarea"),D=r("v-switch"),w=r("v-divider"),b=r("v-btn"),U=r("v-chip"),k=r("v-checkbox"),S=r("v-col"),E=r("v-row"),C=r("v-card-text"),x=r("v-card"),y=r("v-form"),a=r("v-spacer"),V=r("v-card-actions"),z=r("v-dialog");return d(),P(z,{modelValue:o.dialogValue,"onUpdate:modelValue":e[10]||(e[10]=f=>o.dialogValue=f),"max-width":"800",persistent:""},{default:l(()=>[t(x,null,{default:l(()=>[t(h,null,{default:l(()=>[m(c(i.editingRole?"Edit Role":"Add New Role"),1)]),_:1}),t(C,null,{default:l(()=>[i.editingRole&&i.editingRole.is_system?(d(),P(v,{key:0,type:"info",variant:"tonal",class:"mb-4"},{default:l(()=>e[11]||(e[11]=[n("strong",null,"System Role:",-1),m(" This is a system role. Core properties (name, slug, description, status, order) cannot be modified. Only permissions can be updated using the permissions button. ")])),_:1,__:[11]})):A("",!0),t(y,{ref:"roleForm",onSubmit:e[6]||(e[6]=q(f=>s.$emit("save"),["prevent"]))},{default:l(()=>[t(_,{modelValue:i.form.name,"onUpdate:modelValue":e[0]||(e[0]=f=>i.form.name=f),label:"Role Name",rules:[i.rules.required],required:"",hint:"Display name for the role","persistent-hint":"",class:"mb-4",variant:"outlined",placeholder:"e.g., Administrator",disabled:i.editingRole&&i.editingRole.is_system,onBlur:i.autoGenerateSlugFromName},null,8,["modelValue","rules","disabled","onBlur"]),t(_,{modelValue:i.form.slug,"onUpdate:modelValue":e[1]||(e[1]=f=>i.form.slug=f),label:"Slug",hint:"URL-friendly identifier (auto-generated if empty)","persistent-hint":"",class:"mb-4",variant:"outlined",placeholder:"e.g., admin",disabled:i.editingRole&&i.editingRole.is_system},null,8,["modelValue","disabled"]),t(G,{modelValue:i.form.description,"onUpdate:modelValue":e[2]||(e[2]=f=>i.form.description=f),label:"Description",hint:"Brief description of the role","persistent-hint":"",rows:"2",class:"mb-4",variant:"outlined",placeholder:"Short summary of this role",disabled:i.editingRole&&i.editingRole.is_system},null,8,["modelValue","disabled"]),t(_,{modelValue:i.form.order,"onUpdate:modelValue":e[3]||(e[3]=f=>i.form.order=f),modelModifiers:{number:!0},label:"Order",type:"number",hint:"Display order (lower numbers first)","persistent-hint":"",class:"mb-4",variant:"outlined",placeholder:"0",disabled:i.editingRole&&i.editingRole.is_system},null,8,["modelValue","disabled"]),t(D,{modelValue:i.form.is_active,"onUpdate:modelValue":e[4]||(e[4]=f=>i.form.is_active=f),label:"Active",hint:"Inactive roles cannot be assigned to users","persistent-hint":"",class:"mb-4",disabled:i.editingRole&&i.editingRole.is_system},null,8,["modelValue","disabled"]),t(w,{class:"my-4"}),n("div",L,[n("div",M,[e[14]||(e[14]=n("div",null,[n("h3",{class:"text-h6 mb-1"},"Permissions"),n("p",{class:"text-caption text-grey"},"Select permissions to assign to this role")],-1)),n("div",H,[t(b,{size:"small",variant:"outlined",onClick:i.selectAllPermissions,color:"primary"},{default:l(()=>e[12]||(e[12]=[m(" Select All ")])),_:1,__:[12]},8,["onClick"]),t(b,{size:"small",variant:"outlined",onClick:i.deselectAllPermissions,color:"grey"},{default:l(()=>e[13]||(e[13]=[m(" Deselect All ")])),_:1,__:[13]},8,["onClick"])])])]),t(_,{modelValue:o.permissionSearchValue,"onUpdate:modelValue":e[5]||(e[5]=f=>o.permissionSearchValue=f),label:"Search permissions","prepend-inner-icon":"mdi-magnify",variant:"outlined",density:"compact",clearable:"",class:"mb-4",hint:"Search by name, slug, or description","persistent-hint":"",placeholder:"Search permissions"},null,8,["modelValue"]),Object.keys(i.filteredGroupedPermissions).length>0?(d(),p("div",T,[(d(!0),p(I,null,j(i.filteredGroupedPermissions,(f,F)=>(d(),p("div",{key:F,class:"permission-group mb-4"},[t(x,{variant:"outlined"},{default:l(()=>[t(h,{class:"d-flex justify-space-between align-center py-2"},{default:l(()=>[n("div",J,[n("span",K,c(F.charAt(0).toUpperCase()+F.slice(1)),1),t(U,{size:"small",color:"primary",variant:"flat"},{default:l(()=>[m(c(i.getSelectedCountInGroup(F))+" / "+c(f.length)+" selected ",1)]),_:2},1024)]),n("div",Q,[t(b,{size:"x-small",variant:"text",onClick:R=>i.selectAllInGroup(F),color:"primary"},{default:l(()=>e[15]||(e[15]=[m(" Select All ")])),_:2,__:[15]},1032,["onClick"]),t(b,{size:"x-small",variant:"text",onClick:R=>i.deselectAllInGroup(F),color:"grey"},{default:l(()=>e[16]||(e[16]=[m(" Clear ")])),_:2,__:[16]},1032,["onClick"])])]),_:2},1024),t(C,null,{default:l(()=>[Array.isArray(f)?(d(),P(E,{key:0},{default:l(()=>[(d(!0),p(I,null,j(f,R=>(d(),P(S,{key:R.id,cols:"12",md:"6",lg:"4"},{default:l(()=>[t(k,{"model-value":i.isFormPermissionSelected(R.id),"onUpdate:modelValue":we=>i.toggleFormPermission(R.id),label:R.name,hint:R.description,"persistent-hint":"",density:"comfortable",color:"primary"},{label:l(()=>[n("div",null,[n("div",W,c(R.name),1),R.description?(d(),p("div",X,c(R.description),1)):A("",!0)])]),_:2},1032,["model-value","onUpdate:modelValue","label","hint"])]),_:2},1024))),128))]),_:2},1024)):A("",!0)]),_:2},1024)]),_:2},1024)]))),128))])):(d(),P(v,{key:1,type:"info",variant:"tonal",class:"mb-4"},{default:l(()=>[o.permissionSearchValue?(d(),p("div",Y,' No permissions found matching "'+c(o.permissionSearchValue)+'" ',1)):(d(),p("div",Z," No permissions available. Please ensure permissions are loaded. "))]),_:1}))]),_:1},512)]),_:1}),t(V,null,{default:l(()=>[t(a),t(b,{onClick:e[7]||(e[7]=f=>s.$emit("close")),variant:"text"},{default:l(()=>e[17]||(e[17]=[m("Cancel")])),_:1,__:[17]}),i.editingRole&&i.editingRole.is_system?(d(),P(b,{key:0,onClick:e[8]||(e[8]=f=>s.$emit("close")),color:"primary"},{default:l(()=>e[18]||(e[18]=[m(" Close ")])),_:1,__:[18]})):(d(),P(b,{key:1,onClick:e[9]||(e[9]=f=>s.$emit("save")),color:"primary",loading:i.saving},{default:l(()=>[m(c(i.editingRole?"Update":"Create"),1)]),_:1},8,["loading"]))]),_:1})]),_:1})]),_:1},8,["modelValue"])}const ee=O(B,[["render",$]]),se={name:"RolePermissionsDialog",props:{modelValue:{type:Boolean,default:!1},selectedRole:{type:Object,default:null},loadingPermissions:{type:Boolean,default:!1},savingPermissions:{type:Boolean,default:!1},safeGroupedPermissions:{type:Object,default:()=>({})},isPermissionSelected:{type:Function,required:!0},togglePermission:{type:Function,required:!0}},emits:["update:modelValue","close","save"],computed:{dialogValue:{get(){return this.modelValue},set(s){this.$emit("update:modelValue",s)}}}},ie={key:0,class:"text-center py-4"},te={key:1},oe={key:0,class:"text-center py-4"},le={key:1},ne={class:"text-h6 mb-3"};function re(s,e,i,g,u,o){const h=r("v-chip"),v=r("v-card-title"),_=r("v-progress-circular"),G=r("v-checkbox"),D=r("v-col"),w=r("v-row"),b=r("v-alert"),U=r("v-card-text"),k=r("v-spacer"),S=r("v-btn"),E=r("v-card-actions"),C=r("v-card"),x=r("v-dialog");return d(),P(x,{modelValue:o.dialogValue,"onUpdate:modelValue":e[2]||(e[2]=y=>o.dialogValue=y),"max-width":"800",persistent:""},{default:l(()=>[t(C,null,{default:l(()=>[t(v,null,{default:l(()=>{var y,a;return[m(" Manage Permissions - "+c((y=i.selectedRole)==null?void 0:y.name)+" ",1),(a=i.selectedRole)!=null&&a.is_system?(d(),P(h,{key:0,color:"warning",size:"small",class:"ml-2"},{default:l(()=>e[3]||(e[3]=[m(" System Role ")])),_:1,__:[3]})):A("",!0)]}),_:1}),t(U,null,{default:l(()=>[i.loadingPermissions?(d(),p("div",ie,[t(_,{indeterminate:"",color:"primary"})])):(d(),p("div",te,[Object.keys(i.safeGroupedPermissions).length===0?(d(),p("div",oe,e[4]||(e[4]=[n("p",{class:"text-grey"},"No permissions available",-1)]))):(d(),p("div",le,[(d(!0),p(I,null,j(i.safeGroupedPermissions,(y,a)=>(d(),p("div",{key:a,class:"mb-6"},[n("h3",ne,c(a.charAt(0).toUpperCase()+a.slice(1)),1),Array.isArray(y)?(d(),P(w,{key:0},{default:l(()=>[(d(!0),p(I,null,j(y,V=>(d(),P(D,{key:V.id,cols:"12",md:"6"},{default:l(()=>[t(G,{"model-value":i.isPermissionSelected(V.id),"onUpdate:modelValue":z=>i.togglePermission(V.id),label:V.name,hint:V.description,"persistent-hint":"",density:"compact"},null,8,["model-value","onUpdate:modelValue","label","hint"])]),_:2},1024))),128))]),_:2},1024)):(d(),P(b,{key:1,type:"warning",variant:"tonal",class:"mt-2"},{default:l(()=>e[5]||(e[5]=[m(" Invalid permission group structure ")])),_:1,__:[5]}))]))),128))]))]))]),_:1}),t(E,null,{default:l(()=>[t(k),t(S,{onClick:e[0]||(e[0]=y=>s.$emit("close")),variant:"text"},{default:l(()=>e[6]||(e[6]=[m("Cancel")])),_:1,__:[6]}),t(S,{onClick:e[1]||(e[1]=y=>s.$emit("save")),color:"primary",loading:i.savingPermissions},{default:l(()=>e[7]||(e[7]=[m(" Save Permissions ")])),_:1,__:[7]},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])}const ae=O(se,[["render",re]]),de={components:{RoleDialog:ee,RolePermissionsDialog:ae},mixins:[N],data(){return{roles:[],permissions:[],groupedPermissions:{},dialog:!1,permissionDialog:!1,editingRole:null,selectedRole:null,loadingPermissions:!1,savingPermissions:!1,selectedPermissions:[],activeFilter:null,activeOptions:[{title:"Active",value:!0},{title:"Inactive",value:!1}],form:{name:"",slug:"",description:"",is_active:!0,order:0,permissions:[]},permissionSearch:"",rules:{required:s=>!!s||"This field is required"},autoGeneratingSlug:!1}},computed:{safeGroupedPermissions(){if(!this.groupedPermissions||typeof this.groupedPermissions!="object")return{};const s={};return Object.keys(this.groupedPermissions).forEach(e=>{Array.isArray(this.groupedPermissions[e])&&(s[e]=this.groupedPermissions[e])}),s},filteredGroupedPermissions(){if(!this.permissionSearch)return this.safeGroupedPermissions;const s=this.permissionSearch.toLowerCase(),e={};return Object.keys(this.safeGroupedPermissions).forEach(i=>{const g=this.safeGroupedPermissions[i];if(Array.isArray(g)){const u=g.filter(o=>{const h=(o.name||"").toLowerCase(),v=(o.description||"").toLowerCase(),_=(o.slug||"").toLowerCase();return h.includes(s)||v.includes(s)||_.includes(s)});u.length>0&&(e[i]=u)}}),e}},async mounted(){await this.loadRoles(),await this.loadPermissions()},methods:{async loadRoles(){var s;try{this.loading=!0;const e=this.buildPaginationParams();this.search&&(e.search=this.search),this.activeFilter!==null&&(e.active=this.activeFilter);const i=await this.$axios.get("/api/v1/roles",{params:e,headers:this.getAuthHeaders()});i.data.data?(this.roles=i.data.data||[],this.updatePagination(i.data)):(this.roles=i.data||[],this.pagination={current_page:1,last_page:1,per_page:this.roles.length,total:this.roles.length}),this.roles.length===0&&console.warn("No roles found. Run the seeder to create default roles.")}catch(e){((s=e.response)==null?void 0:s.status)===404?this.handleApiError(e,"Roles endpoint not found. Please ensure migrations and seeders have run."):this.handleApiError(e,"Failed to load roles")}finally{this.loading=!1}},async loadPermissions(){try{const s=await this.$axios.get("/api/v1/permissions",{params:{grouped:!0},headers:this.getAuthHeaders()});let e=s.data;if(s.data&&s.data.data&&(e=s.data.data),!e||typeof e!="object"){console.warn("Invalid permissions response structure:",e),this.groupedPermissions={},this.permissions=[];return}Array.isArray(e)?(this.groupedPermissions={},e.forEach(i=>{const g=i.group||i.group_name||"general";this.groupedPermissions[g]||(this.groupedPermissions[g]=[]),this.groupedPermissions[g].push(i)})):this.groupedPermissions=e,this.permissions=[],Object.values(this.groupedPermissions).forEach(i=>{Array.isArray(i)?this.permissions.push(...i):console.warn("Invalid group structure:",i)})}catch(s){console.error("Error loading permissions:",s),this.groupedPermissions={},this.permissions=[],this.handleApiError(s,"Failed to load permissions")}},async openDialog(s){if(Object.keys(this.groupedPermissions).length===0&&await this.loadPermissions(),s){this.editingRole=s;let e=[];if(s.permissions)e=s.permissions.map(i=>typeof i=="object"&&i.id?i.id:i);else try{const i=await this.$axios.get(`/api/v1/roles/${s.id}`,{headers:this.getAuthHeaders()});i.data&&i.data.permissions&&(e=i.data.permissions.map(g=>typeof g=="object"&&g.id?g.id:g))}catch(i){console.warn("Could not load role permissions:",i)}this.form={name:s.name,slug:s.slug,description:s.description||"",is_active:s.is_active,order:s.order||0,permissions:e}}else this.editingRole=null,this.form={name:"",slug:"",description:"",is_active:!0,order:0,permissions:[]};this.dialog=!0},closeDialog(){var s,e;this.dialog=!1,this.editingRole=null,this.permissionSearch="",this.form={name:"",slug:"",description:"",is_active:!0,order:0,permissions:[]},(e=(s=this.$refs.roleDialog)==null?void 0:s.resetValidation)==null||e.call(s)},autoGenerateSlugFromName(){!this.form.slug&&this.form.name&&!this.editingRole&&(this.form.slug=this.form.name.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,""))},async saveRole(){var s,e,i,g,u;if(!((s=this.$refs.roleDialog)!=null&&s.validateForm)){this.showError("Form reference not found");return}if(this.$refs.roleDialog.validateForm()){!this.form.slug&&this.form.name&&(this.form.slug=this.form.name.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"")),this.saving=!0;try{const o=this.editingRole?`/api/v1/roles/${this.editingRole.id}`:"/api/v1/roles",h=this.editingRole?"put":"post",v={name:this.form.name.trim(),description:this.form.description?this.form.description.trim():null,is_active:this.form.is_active===!0||this.form.is_active==="true"||this.form.is_active===1,order:parseInt(this.form.order)||0};this.editingRole?this.form.slug!==this.editingRole.slug&&(this.form.slug&&this.form.slug.trim()?v.slug=this.form.slug.trim():v.slug=""):this.form.slug&&this.form.slug.trim()&&(v.slug=this.form.slug.trim()),this.form.permissions&&Array.isArray(this.form.permissions)&&(v.permissions=this.form.permissions),await this.$axios[h](o,v,{headers:this.getAuthHeaders()}),this.showSuccess(this.editingRole?"Role updated successfully":"Role created successfully"),this.closeDialog(),await this.loadRoles()}catch(o){if(console.error("Error saving role:",o),console.error("Error response:",o.response),(i=(e=o.response)==null?void 0:e.data)!=null&&i.errors){const h=o.response.data.errors,v=[];Object.keys(h).forEach(_=>{Array.isArray(h[_])?v.push(`${_}: ${h[_][0]}`):v.push(`${_}: ${h[_]}`)})}else(u=(g=o.response)==null?void 0:g.data)!=null&&u.message&&o.response.data.message;this.handleApiError(o,"Error saving role")}finally{this.saving=!1}}},async deleteRole(s){if(s.is_system){this.showError("System roles cannot be deleted");return}if(confirm(`Are you sure you want to delete the role "${s.name}"?`))try{await this.$axios.delete(`/api/v1/roles/${s.id}`,{headers:this.getAuthHeaders()}),this.showSuccess("Role deleted successfully"),await this.loadRoles()}catch(e){this.handleApiError(e,"Error deleting role")}},async openPermissionDialog(s){this.selectedRole=s,this.selectedPermissions=s.permissions?s.permissions.map(e=>e.id||e):[],this.permissionDialog=!0},closePermissionDialog(){this.permissionDialog=!1,this.selectedRole=null,this.selectedPermissions=[]},isPermissionSelected(s){return this.selectedPermissions.includes(s)},togglePermission(s){const e=this.selectedPermissions.indexOf(s);e>-1?this.selectedPermissions.splice(e,1):this.selectedPermissions.push(s)},isFormPermissionSelected(s){return this.form.permissions.includes(s)},toggleFormPermission(s){const e=this.form.permissions.indexOf(s);e>-1?this.form.permissions.splice(e,1):this.form.permissions.push(s)},getSelectedCountInGroup(s){const e=this.filteredGroupedPermissions[s]||this.safeGroupedPermissions[s];return!e||!Array.isArray(e)?0:e.filter(i=>this.form.permissions.includes(i.id)).length},selectAllPermissions(){this.permissions.forEach(s=>{this.form.permissions.includes(s.id)||this.form.permissions.push(s.id)})},deselectAllPermissions(){this.form.permissions=[]},selectAllInGroup(s){const e=this.filteredGroupedPermissions[s]||this.safeGroupedPermissions[s];e&&Array.isArray(e)&&e.forEach(i=>{this.form.permissions.includes(i.id)||this.form.permissions.push(i.id)})},deselectAllInGroup(s){const e=this.filteredGroupedPermissions[s]||this.safeGroupedPermissions[s];if(e&&Array.isArray(e)){const i=e.map(g=>g.id);this.form.permissions=this.form.permissions.filter(g=>!i.includes(g))}},async savePermissions(){this.savingPermissions=!0;try{await this.$axios.put(`/api/v1/roles/${this.selectedRole.id}/permissions`,{permissions:this.selectedPermissions},{headers:this.getAuthHeaders()}),this.showSuccess("Permissions updated successfully"),this.closePermissionDialog(),await this.loadRoles()}catch(s){this.handleApiError(s,"Error saving permissions")}finally{this.savingPermissions=!1}},onPerPageChange(){this.resetPagination(),this.loadRoles()},onSort(s){this.handleSort(s),this.loadRoles()}}},me={class:"page-header"},ue={class:"text-caption text-grey"},ce={key:0},pe={class:"d-flex align-center"},ge={class:"d-flex align-center"},fe={class:"d-flex align-center"},he={class:"font-weight-medium"},ve={class:"text-caption text-grey"},_e={key:1,class:"text-caption"},ye={key:0},Pe={class:"d-flex flex-column flex-md-row justify-space-between align-center align-md-start gap-3 mt-4"},be={class:"text-caption text-grey"},Ve={key:0},Re={key:0,class:"ml-2"},Se={key:1},Ae={key:0,class:"d-flex align-center gap-2"};function ke(s,e,i,g,u,o){const h=r("v-btn"),v=r("v-select"),_=r("v-col"),G=r("v-text-field"),D=r("v-row"),w=r("v-card-text"),b=r("v-card"),U=r("v-card-title"),k=r("v-icon"),S=r("v-chip"),E=r("v-table"),C=r("v-pagination"),x=r("RoleDialog"),y=r("RolePermissionsDialog");return d(),p("div",null,[n("div",me,[e[12]||(e[12]=n("h1",{class:"text-h4 page-title"},"Role Management",-1)),t(h,{color:"primary","prepend-icon":"mdi-plus",onClick:e[0]||(e[0]=a=>o.openDialog(null)),class:"add-button"},{default:l(()=>e[11]||(e[11]=[m(" Add New Role ")])),_:1,__:[11]})]),t(b,{class:"mb-4"},{default:l(()=>[t(w,null,{default:l(()=>[t(D,null,{default:l(()=>[t(_,{cols:"12",md:"2"},{default:l(()=>[t(v,{modelValue:s.perPage,"onUpdate:modelValue":[e[1]||(e[1]=a=>s.perPage=a),o.onPerPageChange],items:s.perPageOptions,label:"Items per page","prepend-inner-icon":"mdi-format-list-numbered",variant:"outlined",density:"compact"},null,8,["modelValue","items","onUpdate:modelValue"])]),_:1}),t(_,{cols:"12",md:"4"},{default:l(()=>[t(v,{modelValue:u.activeFilter,"onUpdate:modelValue":[e[2]||(e[2]=a=>u.activeFilter=a),o.loadRoles],items:u.activeOptions,label:"Filter by Status","prepend-inner-icon":"mdi-filter",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue","items","onUpdate:modelValue"])]),_:1}),t(_,{cols:"12",md:"6"},{default:l(()=>[t(G,{modelValue:s.search,"onUpdate:modelValue":[e[3]||(e[3]=a=>s.search=a),o.loadRoles],label:"Search roles","prepend-inner-icon":"mdi-magnify",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),t(b,null,{default:l(()=>[t(U,{class:"d-flex justify-space-between align-center"},{default:l(()=>[e[14]||(e[14]=n("span",null,"Roles",-1)),n("span",ue,[e[13]||(e[13]=m(" Total Records: ")),n("strong",null,c(s.pagination.total||0),1),u.roles.length>0?(d(),p("span",ce," | Showing "+c((s.currentPage-1)*s.perPage+1)+" to "+c(Math.min(s.currentPage*s.perPage,s.pagination.total))+" of "+c(s.pagination.total),1)):A("",!0)])]),_:1,__:[14]}),t(w,null,{default:l(()=>[t(E,null,{default:l(()=>[n("thead",null,[n("tr",null,[n("th",{class:"sortable",onClick:e[4]||(e[4]=a=>o.onSort("name"))},[n("div",pe,[e[15]||(e[15]=m(" Name ")),t(k,{icon:s.getSortIcon("name"),size:"small",class:"ml-1"},null,8,["icon"])])]),n("th",{class:"sortable",onClick:e[5]||(e[5]=a=>o.onSort("slug"))},[n("div",ge,[e[16]||(e[16]=m(" Slug ")),t(k,{icon:s.getSortIcon("slug"),size:"small",class:"ml-1"},null,8,["icon"])])]),e[18]||(e[18]=n("th",null,"Permissions",-1)),n("th",{class:"sortable",onClick:e[6]||(e[6]=a=>o.onSort("is_active"))},[n("div",fe,[e[17]||(e[17]=m(" Status ")),t(k,{icon:s.getSortIcon("is_active"),size:"small",class:"ml-1"},null,8,["icon"])])]),e[19]||(e[19]=n("th",null,"Type",-1)),e[20]||(e[20]=n("th",null,"Actions",-1))])]),n("tbody",null,[(d(!0),p(I,null,j(u.roles,a=>(d(),p("tr",{key:a.id},[n("td",null,[n("div",he,c(a.name),1),n("div",ve,c(a.description||"No description"),1)]),n("td",null,[t(S,{size:"small",variant:"outlined"},{default:l(()=>[m(c(a.slug),1)]),_:2},1024)]),n("td",null,[t(S,{size:"small",color:"primary",variant:"text"},{default:l(()=>[m(c(a.permissions?a.permissions.length:0)+" permissions ",1)]),_:2},1024)]),n("td",null,[t(S,{color:a.is_active?"success":"error",size:"small"},{default:l(()=>[m(c(a.is_active?"Active":"Inactive"),1)]),_:2},1032,["color"])]),n("td",null,[a.is_system?(d(),P(S,{key:0,color:"warning",size:"small"},{default:l(()=>e[21]||(e[21]=[m(" System ")])),_:1,__:[21]})):(d(),p("span",_e,"Custom"))]),n("td",null,[t(h,{size:"small",icon:"mdi-pencil",onClick:V=>o.openDialog(a),variant:"text",disabled:a.is_system},null,8,["onClick","disabled"]),t(h,{size:"small",icon:"mdi-shield-key",onClick:V=>o.openPermissionDialog(a),variant:"text"},null,8,["onClick"]),t(h,{size:"small",icon:"mdi-delete",onClick:V=>o.deleteRole(a),variant:"text",color:"error",disabled:a.is_system},null,8,["onClick","disabled"])])]))),128)),u.roles.length===0?(d(),p("tr",ye,e[22]||(e[22]=[n("td",{colspan:"6",class:"text-center py-4"},"No roles found",-1)]))):A("",!0)])]),_:1}),n("div",Pe,[n("div",be,[u.roles.length>0&&s.pagination.total>0?(d(),p("span",Ve,[e[23]||(e[23]=m(" Showing ")),n("strong",null,c((s.currentPage-1)*s.perPage+1),1),e[24]||(e[24]=m(" to ")),n("strong",null,c(Math.min(s.currentPage*s.perPage,s.pagination.total)),1),e[25]||(e[25]=m(" of ")),n("strong",null,c(s.pagination.total.toLocaleString()),1),e[26]||(e[26]=m(" records ")),s.pagination.last_page>1?(d(),p("span",Re," (Page "+c(s.currentPage)+" of "+c(s.pagination.last_page)+") ",1)):A("",!0)])):(d(),p("span",Se," No records found "))]),s.pagination.last_page>1?(d(),p("div",Ae,[t(C,{modelValue:s.currentPage,"onUpdate:modelValue":[e[7]||(e[7]=a=>s.currentPage=a),o.loadRoles],length:s.pagination.last_page,"total-visible":7,density:"comfortable"},null,8,["modelValue","length","onUpdate:modelValue"])])):A("",!0)])]),_:1})]),_:1}),t(x,{ref:"roleDialog",modelValue:u.dialog,"onUpdate:modelValue":e[8]||(e[8]=a=>u.dialog=a),"editing-role":u.editingRole,saving:s.saving,form:u.form,rules:u.rules,"permission-search":u.permissionSearch,"onUpdate:permissionSearch":e[9]||(e[9]=a=>u.permissionSearch=a),"filtered-grouped-permissions":o.filteredGroupedPermissions,"get-selected-count-in-group":o.getSelectedCountInGroup,"is-form-permission-selected":o.isFormPermissionSelected,"toggle-form-permission":o.toggleFormPermission,"select-all-permissions":o.selectAllPermissions,"deselect-all-permissions":o.deselectAllPermissions,"select-all-in-group":o.selectAllInGroup,"deselect-all-in-group":o.deselectAllInGroup,"auto-generate-slug-from-name":o.autoGenerateSlugFromName,onSave:o.saveRole,onClose:o.closeDialog},null,8,["modelValue","editing-role","saving","form","rules","permission-search","filtered-grouped-permissions","get-selected-count-in-group","is-form-permission-selected","toggle-form-permission","select-all-permissions","deselect-all-permissions","select-all-in-group","deselect-all-in-group","auto-generate-slug-from-name","onSave","onClose"]),t(y,{modelValue:u.permissionDialog,"onUpdate:modelValue":e[10]||(e[10]=a=>u.permissionDialog=a),"selected-role":u.selectedRole,"loading-permissions":u.loadingPermissions,"saving-permissions":u.savingPermissions,"safe-grouped-permissions":o.safeGroupedPermissions,"is-permission-selected":o.isPermissionSelected,"toggle-permission":o.togglePermission,onSave:o.savePermissions,onClose:o.closePermissionDialog},null,8,["modelValue","selected-role","loading-permissions","saving-permissions","safe-grouped-permissions","is-permission-selected","toggle-permission","onSave","onClose"])])}const Fe=O(de,[["render",ke],["__scopeId","data-v-a3c9e9f7"]]);export{Fe as default};
